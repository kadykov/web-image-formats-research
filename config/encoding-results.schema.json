{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Encoding Results",
  "description": "Schema for the output of an encoding study. Records all encoded files, their encoding parameters, and basic file-level metadata. This file serves as the input for the quality measurement stage.",
  "type": "object",
  "required": ["study_id", "study_name", "dataset", "encodings"],
  "properties": {
    "study_id": {
      "type": "string",
      "description": "Identifier of the study that produced these results"
    },
    "study_name": {
      "type": "string",
      "description": "Human-readable name of the study"
    },
    "dataset": {
      "type": "object",
      "description": "Information about the source dataset used",
      "required": ["id", "path", "image_count"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Dataset identifier"
        },
        "path": {
          "type": "string",
          "description": "Path to the dataset directory (relative to project root)"
        },
        "image_count": {
          "type": "integer",
          "description": "Number of images used from the dataset",
          "minimum": 1
        }
      },
      "additionalProperties": false
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of when the encoding was completed",
      "format": "date-time"
    },
    "encodings": {
      "type": "array",
      "description": "List of all encoded image records",
      "items": {
        "type": "object",
        "required": [
          "source_image",
          "encoded_path",
          "format",
          "quality",
          "file_size"
        ],
        "properties": {
          "source_image": {
            "type": "string",
            "description": "Path to the source image used for encoding (relative to project root). This is the image the encoder received as input â€” either the original dataset image or a preprocessed (resized) copy."
          },
          "original_image": {
            "type": "string",
            "description": "Path to the original dataset image (relative to project root). Always points to the unmodified image from the dataset, even when preprocessing was applied. This is the reference for quality measurements."
          },
          "encoded_path": {
            "type": "string",
            "description": "Path to the encoded output file (relative to project root)"
          },
          "format": {
            "type": "string",
            "description": "Encoding format used",
            "enum": ["jpeg", "webp", "avif", "jxl"]
          },
          "quality": {
            "type": "integer",
            "description": "Quality setting used for encoding",
            "minimum": 0,
            "maximum": 100
          },
          "chroma_subsampling": {
            "type": "string",
            "description": "Chroma subsampling mode used, if applicable",
            "enum": ["444", "422", "420", "400"]
          },
          "speed": {
            "type": "integer",
            "description": "Speed setting for AVIF encoder (0-10, lower is slower/better), if applicable"
          },
          "effort": {
            "type": "integer",
            "description": "Effort setting for JPEG XL encoder (1-10, higher is slower/better), if applicable"
          },
          "method": {
            "type": "integer",
            "description": "Compression method for WebP encoder (0-6, higher is slower/better), if applicable"
          },
          "resolution": {
            "type": "integer",
            "description": "Target resolution (longest edge in pixels) if preprocessing was applied. Absent if original resolution was used."
          },
          "width": {
            "type": "integer",
            "description": "Width of the encoded image in pixels",
            "minimum": 1
          },
          "height": {
            "type": "integer",
            "description": "Height of the encoded image in pixels",
            "minimum": 1
          },
          "source_file_size": {
            "type": "integer",
            "description": "File size of the source image in bytes",
            "minimum": 0
          },
          "file_size": {
            "type": "integer",
            "description": "File size of the encoded image in bytes",
            "minimum": 1
          },
          "extra_args": {
            "type": "object",
            "description": "Any encoder-specific extra arguments that were used",
            "additionalProperties": {
              "type": ["string", "integer", "boolean"]
            }
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
